!function(e){"use strict";if("undefined"==typeof _wlwl_get_email_params||!_wlwl_get_email_params?.coupon_type)return;let l,t,w,o,n=_wlwl_get_email_params,i=window.innerWidth,_=window.innerHeight,a=i<760,r=n?.wlwl_mobile_enable;if(a&&!r)return;let s=n.coupon_type.length,c=360/s,h=-c/2;function d(t,w,o){let i=e("#wlwl_canvas"),_=e("#wlwl_canvas2"),a="";window.devicePixelRatio&&(a="width:"+l+"px;height:"+l+"px;"),i.attr("style",a),_.attr("style",a);let r=360-c*t,s=n.spinning_time,h=360*n.wheel_speed*s+r,d=a+"-moz-transform: rotate("+h+"deg);-webkit-transform: rotate("+h+"deg);-o-transform: rotate("+h+"deg);-ms-transform: rotate("+h+"deg);transform: rotate("+h+"deg);";d+="-webkit-transition: transform "+s+"s ease;-moz-transition: transform "+s+"s ease;-ms-transition: transform "+s+"s ease;-o-transition: transform "+s+"s ease;transition: transform "+s+"s ease;",i.attr("style",d),_.attr("style",d),setTimeout((function(){d=a+"transform: rotate("+r+"deg);",i.attr("style",d),_.attr("style",d),e(".wlwl_lucky_wheel_content").addClass("wlwl-finish-spinning"),e(".wlwl-overlay").off().on("click",(function(){e("html").removeClass("wlwl-html"),e(this).hide(),e(".wlwl_lucky_wheel_content").removeClass("lucky_wheel_content_show"),e(".wlwl_wheel_spin").css({"margin-left":"0",transition:"2s"})})),e(".wlwl_user_lucky").html('<div class="wlwl-frontend-result">'+w+"</div>").fadeIn(300);let l=parseInt(n.auto_close);l>0&&setTimeout((function(){e(".wlwl-overlay").trigger("click")}),1e3*l)}),parseInt(1e3*s))}function m(e,l,t){let w=new Date;w.setTime(w.getTime()+1e3*t);let o="expires="+w.toUTCString();document.cookie=e+"="+l+";"+o+";path=/"}function u(e){let l=e+"=",t=decodeURIComponent(document.cookie).split(";");for(let e=0;e<t.length;e++){let w=t[e];for(;" "==w.charAt(0);)w=w.substring(1);if(0==w.indexOf(l))return w.substring(l.length,w.length)}return""}function p(e,w){o.beginPath(),o.fillStyle=w,o.moveTo(t,t);let n=t;32!==t&&(n=l<=480?l/2-10:l/2-14),o.arc(t,t,n,f(e),f(e+c)),o.lineTo(t,t),o.fill()}function f(e){return e*Math.PI/180}function y(e,l,w,n,i,_=""){let a,r,h;o.beginPath(),o.strokeStyle=e,o.lineWidth=w,_&&(o.shadowBlur=1,o.shadowOffsetX=8,o.shadowOffsetY=8,o.shadowColor=_),o.arc(t,t,t,0,2*Math.PI),o.stroke(),h=c/2;let d=t-i;for(let e=0;e<s;e++)o.beginPath(),o.fillStyle=l,a=t+d*Math.cos(h*Math.PI/180),r=t-d*Math.sin(h*Math.PI/180),o.arc(a,r,n,0,2*Math.PI),o.fill(),h+=c}function g(e,w,i){let _="Helvetica",a=parseInt(l/28)*parseInt(n.font_size)/100;void 0!==n.font_text_wheel&&""!==n.font_text_wheel&&(_=n.font_text_wheel),o.save(),o.translate(t,t),o.rotate(f(e)),o.textAlign="right",o.fillStyle=i,o.font="200 "+a+"px "+_,o.shadowOffsetX=0,o.shadowOffsetY=0;let r=(w=(w=w.replace(/&#(\d{1,4});/g,(function(e,l){return String.fromCharCode(l)}))).replace(/&nbsp;/g," ")).split("/n"),s="",c="";r.length>1?(s=r[0],c=r.splice(1,r.length-1),c=c.join("")):(r=w.split("\\n"),r.length>1&&(s=r[0],c=r.splice(1,r.length-1),c=c.join(""))),""!==s.trim()&&""!==c.trim()?(o.fillText(s.trim(),7*t/8,-1*a/4),o.fillText(c.trim(),7*t/8,3*a/4)):o.fillText(w.replace(/\\n/g,"").replace(/\/n/g,""),7*t/8,a/2-2),o.restore()}async function k(i){var _;if(i&&(w=document.getElementById(i),w))switch(o=w.getContext("2d"),w.width=l,w.height=l,window.devicePixelRatio&&(e(w).attr({width:l*window.devicePixelRatio,height:l*window.devicePixelRatio}),e(w).css({width:l,height:l}),o.scale(window.devicePixelRatio,window.devicePixelRatio)),i){case"wlwl_canvas":for(let e=0;e<s;e++)p(h,n.bg_color[e]),g(h+c/2,n.label[e],n.slice_text_color),h+=c;break;case"wlwl_canvas1":_=n.wheel_center_color,o.save(),o.beginPath(),o.fillStyle=_,o.shadowBlur=1,o.shadowOffsetX=8,o.shadowOffsetY=8,o.shadowColor="rgba(0,0,0,0.2)",o.arc(t,t,l/8,0,2*Math.PI),o.fill(),o.clip(),o.restore(),l<=480?y(n.wheel_border_color,"rgba(0,0,0,0)",20,4,5,"rgba(0,0,0,0.2)"):y(n.wheel_border_color,"rgba(0,0,0,0)",30,6,7,"rgba(0,0,0,0.2)");break;case"wlwl_canvas2":l<=480?y("rgba(0,0,0,0)",n.wheel_dot_color,20,4,5,"rgba(0,0,0,0)"):y("rgba(0,0,0,0)",n.wheel_dot_color,30,6,7,"rgba(0,0,0,0)")}}async function v(w=!1){t=l/2,await k("wlwl_canvas"),await k("wlwl_canvas1"),await k("wlwl_canvas2"),w&&e(".woocommerce-lucky-wheel-popup-icon").trigger("click")}function b(){e(".wlwl_wheel_spin").css({width:l+"px",height:l+"px"}),e(".wlwl_lucky_wheel_content").removeClass("wlwl_lucky_wheel_content_mobile lucky_wheel_content_tablet"),a?e(".wlwl_lucky_wheel_content").addClass("wlwl_lucky_wheel_content_mobile"):("on"===n.show_full_wheel?e(".wlwl_lucky_wheel_content").css({"max-width":l+600+"px"}):e(".wlwl_lucky_wheel_content").css({"max-width":.6*l+600+"px"}),i<1024&&e(".wlwl_lucky_wheel_content").addClass("lucky_wheel_content_tablet")),a&&!n.custom_field_name_enable_mobile?e(".wlwl_field_name_wrap").hide():e(".wlwl_field_name_wrap").show();let t=".wlwl_lucky_wheel_content:not(.wlwl_lucky_wheel_content_mobile) .wheel-content-wrapper .wheel_content_left{min-width:"+(l+35)+"px}";t+=".wlwl_pointer:before{font-size:"+parseInt(l/4)+"px !important; }",e("#wlwl_lucky_wheel_custom_inline_css").length||e("head").append('<style id="wlwl_lucky_wheel_custom_inline_css"></style>'),e("#wlwl_lucky_wheel_custom_inline_css").html(t)}e(window).on("resize",(function(){i=window.innerWidth,_=window.innerHeight,a=i<760,r||!a?e(document.body).trigger("wlwl-render-popup-wheel"):e(".wlwl_lucky_wheel_wrap").removeClass("wlwl_lucky_wheel_active")})),e(document).ready((function(e){setTimeout((function(){e(document.body).trigger("wlwl-render-popup-wheel")}),100),e(document.body).on("wlwl-render-popup-wheel",(function(){if(!u("wlwl_cookie"))if(e(".wlwl_lucky_wheel_wrap").addClass("wlwl_lucky_wheel_active"),l=i>_?_:i,l=a?parseInt(.6*l+16):parseInt(n.wheel_size*(.55*l+16)/100),b(),e(".wlwl_lucky_wheel_content_rendered").length)v();else switch(function(){if(w=document.getElementById("wlwl_popup_canvas"),!w)return;o=w.getContext("2d"),t=32;for(let e=0;e<s;e++)p(h,n.bg_color[e]),h+=c;e=n.wheel_center_color,o.save(),o.beginPath(),o.fillStyle=e,o.arc(t,t,8,0,2*Math.PI),o.fill(),o.restore(),y(n.wheel_border_color,n.wheel_dot_color,4,1,0);var e}(),n.intent){case"popup_icon":setTimeout((function(){e(".wlwl_wheel_icon").addClass("wlwl_show")}),1e3*n.show_wheel);break;case"show_wheel":setTimeout((function(){e(".wlwl_wheel_icon").trigger("click")}),1e3*n.show_wheel)}})),e(document).on("click",".woocommerce-lucky-wheel-popup-icon",(function(){if(!e(".wlwl_lucky_wheel_wrap.wlwl_lucky_wheel_content_rendered").length)return e(".wlwl_lucky_wheel_wrap").addClass("wlwl_lucky_wheel_content_rendered"),void v(!0);e(".wlwl_lucky_wheel_wrap").hasClass("wlwl_lucky_wheel_active")&&(e(".wlwl_wheel_icon").removeClass("wlwl_show"),e(".wlwl-overlay").show(),e("html").addClass("wlwl-html"),e(".wlwl_lucky_wheel_content").addClass("lucky_wheel_content_show"))})),e(document).on("click",".wlwl-close-wheel , .wlwl-close, .wlwl-overlay",(function(){e("html").removeClass("wlwl-html"),e(".wlwl-overlay").hide(),m("wlwl_cookie","closed",n.time_if_close),e(".wlwl_lucky_wheel_content").removeClass("lucky_wheel_content_show"),n.hide_popup||e(".wlwl_wheel_icon").addClass("wlwl_show")})),e(document).on("click",".wlwl-never-again span",(function(){m("wlwl_cookie","never_show_again",2592e3),e(".wlwl_wheel_icon").addClass("wlwl_show"),e(".wlwl-overlay").hide(),e("html").removeClass("wlwl-html"),e(".wlwl_lucky_wheel_content").removeClass("lucky_wheel_content_show")})),e(document).on("click",".wlwl-reminder-later-a",(function(){m("wlwl_cookie","reminder_later",86400),e(".wlwl_wheel_icon").addClass("wlwl_show"),e(".wlwl-overlay").hide(),e("html").removeClass("wlwl-html"),e(".wlwl_lucky_wheel_content").removeClass("lucky_wheel_content_show")})),e(document).on("click",".wlwl-hide-after-spin",(function(){e(".wlwl-overlay").hide(),e("html").removeClass("wlwl-html"),e(".wlwl_lucky_wheel_content").removeClass("lucky_wheel_content_show"),e(".wlwl_wheel_spin").css({"margin-left":"0",transition:"2s"})})),e(document).on("keypress",(function(l){e(".wlwl_lucky_wheel_content").hasClass("lucky_wheel_content_show")&&13===l.keyCode&&e("#wlwl_chek_mail").trigger("click")})),e(document).on("click","#wlwl_chek_mail",(function(){if(!e(".wlwl_lucky_wheel_wrap").hasClass("wlwl_lucky_wheel_active"))return;if(e("#wlwl_error_mail,#wlwl_error_name,#wlwl_error_mobile,#wlwl_warring_recaptcha").html(""),e(".wlwl-required-field").removeClass("wlwl-required-field"),n.gdpr&&!e('.wlwl-gdpr-checkbox-wrap input[type="checkbox"]').prop("checked"))return e("#wlwl_error_mail").html(n.gdpr_warning),!1;let l=e("#wlwl_player_mail").val(),t=e("#wlwl_player_name").val(),w=!0;if(!n.custom_field_name_enable||a&&!n.custom_field_name_enable_mobile||!n.custom_field_name_required||t||(e("#wlwl_error_name").html(n.custom_field_name_message),e(".wlwl_field_name").addClass("wlwl-required-field"),w=!1),l||(e("#wlwl_player_mail").prop("disabled",!1).focus(),e("#wlwl_error_mail").html(n.empty_email_warning),e(".wlwl_field_email").addClass("wlwl-required-field"),w=!1),!1===w)return!1;e(this).unbind(),e(".wlwl-overlay").unbind(),e("#wlwl_player_mail").prop("disabled",!0),""===u("wlwl_cookie")||"closed"===u("wlwl_cookie")?/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/i.test(l)?(e("#wlwl_chek_mail").addClass("wlwl-adding"),e.ajax({type:"post",dataType:"json",url:n.ajaxurl,data:{origin_prize:n.coupon_type,user_email:l,user_name:t,is_desktop:a?"":1,_woocommerce_lucky_wheel_nonce:e("#_woocommerce_lucky_wheel_nonce").val()},success:function(t){if("yes"===t.allow_spin){e(".wlwl-show-again-option").hide(),e(".wlwl-close-wheel").hide(),e(".wlwl-hide-after-spin").show(),d(t.stop_position,t.result_notification,t.result);let w=n.show_again;switch(n.show_again_unit){case"m":w*=60;break;case"h":w*=3600;break;case"d":w*=86400}m("wlwl_cookie",l,w)}else e("#wlwl_chek_mail").removeClass("wlwl-adding"),e("#wlwl_player_mail").prop("disabled",!1),e("#wlwl_error_mail").html(t.warning||t.allow_spin||"")}})):(e("#wlwl_player_mail").prop("disabled",!1).focus(),e("#wlwl_error_mail").html(n.invalid_email_warning),e(".wlwl_field_email").addClass("wlwl-required-field")):(e("#wlwl_error_mail").html(n.limit_time_warning),e("#wlwl_player_mail").prop("disabled",!1))}))}))}(jQuery);